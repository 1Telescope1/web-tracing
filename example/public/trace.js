!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports._trace=t():e._trace=t()}(self,(function(){return function(){var e={328:function(e,t,n){"use strict";n.d(t,{fF:function(){return T},ZP:function(){return x},j8:function(){return I},Hr:function(){return g}});var r=n(839);const o="_warden_session_id";function i(){const e=(0,r.A7)(o)||`s_${(0,r.Vj)()}`,t=new Date(Date.now()+18e5);return document.cookie=`${o}=${e};path=/;max-age=1800;expires=${t.toUTCString()}`,e}i();const a="_warden_device_id",{screen:c}=window,{clientWidth:s,clientHeight:d}=document.documentElement,{width:u,height:l,colorDepth:f,pixelDepth:p}=c;let m=(0,r.A7)(a);m||(m=`t_${(0,r.Vj)()}`,document.cookie=`${a}=${m};path=/;`);var w={clientHeight:d,clientWidth:s,colorDepth:f,pixelDepth:p,deviceId:m,screenWidth:u,screenHeight:l,vendor:navigator.vendor,platform:navigator.platform};const h={debug:!1,hashtag:!1},g=(0,r.Vj)(),v=(0,r.A7)(o)||i();let y="";const b={...w,pageId:g,sessionId:v,sdkVersion:"1.0.0"};let E=[],S=null;function T(...e){h.debug&&console.log(...e)}function C(){if(E.length){const e=E.slice(0,5);E=E.slice(5),T("send events",e);const t=Date.now();(0,r.Zv)(y,{baseInfo:{...b,sendTime:t},eventInfo:(0,r.UI)(e,(e=>{if(e.sendTime=t,"click"===e.eventType||"scroll"===e.eventType||"submit"===e.eventType||"change"===e.eventType)return e.type="mix",e;if("performance"===e.eventType){switch(e.eventId){case"resource":e.type="resourcePerformance";break;case"page":e.type="pagePerformance";break;case"server":e.type="serverPerformance"}return e}return e.type=e.eventType,e}))}),E.length&&(0,r.Rq)(C)}}function I(e,t=!1){E=E.concat(e),i(),T("receive event, waiting to send",e),clearTimeout(S),E.length>=5||t?C():S=setTimeout((()=>{C()}),5e3)}var x={init:function(e={}){const{requestUrl:t,appName:n,appCode:r,appVersion:o,ext:i,...a}=e;y=t,b.appName=n,b.appCode=r,b.ext=i,Object.assign(h,a)},emit:I,getSetting:function(){return h},setCustomerId:function(e){b.customerId=e},setUserUuid:function(e){b.userUuid=e},pageId:g}},752:function(e,t,n){"use strict";var r=n(839),o=n(328);function i(e){const t={...e,eventType:"error",url:window.location.href,triggerTime:Date.now()};(0,o.j8)(t)}function a(e){const{stack:t="",message:n=""}=e,o={errMessage:n,errStack:t};if(t){const e=/^\s*at\s*([^(]+)\s*\((.+?):(\d+):(\d+)\)$/,i=/^\s*([^@]*)@(.+?):(\d+):(\d+)$/,a=t.replace(new RegExp(`^[\\w\\s:]*${n}\n`),""),c=(0,r.UI)((0,r.hX)(a.split("\n"),(e=>e)),(t=>{const n=t.match(e);if(n)return{src:n[2],line:n[3],col:n[4]};const r=t.match(i);return r?{src:r[2],line:r[3],col:r[4]}:{}})),s=c[0]||{};return{...o,...s}}return o}function c(e){if(e instanceof Error){const{message:t,stack:n,lineNumber:r,fileName:o,columnNumber:i}=e;return o?{errMessage:t,errStack:n,line:r,col:i,src:o}:a(e)}return e.message?a(e):"string"==typeof e?{errMessage:e}:{}}function s(e){const{target:t,type:n}=e;if("unhandledrejection"===n)return{eventId:"code",...c(e.reason)};if(1===t.nodeType){const e={eventId:t.nodeName};if("link"===t.nodeName.toLowerCase())e.src=t.href;else e.src=t.currentSrc||t.src;return e}if(e.error){const t=e.error;return t.fileName=t.filename||e.filename,t.columnNumber=t.colno||e.colno,t.lineNumber=t.lineno||e.lineno,{eventId:"code",...c(t)}}return{eventId:"code",line:window.event.errorLine,col:window.event.errorCharacter,message:window.event.errorMessage,src:window.event.errorUrl}}t.Z={init({errorCore:e}){if(!e)return;window.addEventListener("error",(e=>{console.log("error捕获类型"),i(s(e))}),!0),window.addEventListener("unhandledrejection",(e=>{console.log("unhandledrejection捕获类型"),i(s(e))}));const t=console.error;console.error=function(...e){console.log("console.error捕获类型"),e.forEach((e=>{i({eventId:"code",...c(e)})})),t.apply(console,e)}},traceError(e,t,n={}){const r={eventId:e,errMessage:t,...n},{params:o}=r;return o&&(r.params=o),i(r)}}},15:function(e,t,n){"use strict";var r=n(328),o=n(839);class i{constructor(e={}){["eventType","eventId","url","referer","action","params","millisecond"].forEach((t=>{this[t]=e[t]||null}))}}class a{constructor(e={}){["eventType","eventId","url","params","title","x","y"].forEach((t=>{this[t]=e[t]||null}))}}function c(e){if(e.length>0){const t=["em","b","strong","span","img","i","code"];return e.filter((({tagName:e})=>t.indexOf(e.toLowerCase())>=0)).length===e.length}return!0}function s(e,t=""){if(!e)return t;const n=e.parentElement;let r=0;const{id:o}=e,i=e.tagName.toLowerCase(),a=t?`>${t}`:"",c=r?`.${r}`:"";return n&&n!==window&&n!==document.documentElement&&n!==document.body?o?`#${o}${a}`:(n.children.length>1&&(r=Array.prototype.indexOf.call(n.children,e)),s(n,`${i}${c}${a}`)):`${i}${a}`}function d(){const e=new a({eventType:"click"});document.addEventListener("click",(t=>{(0,r.fF)("caught click event: ",t);let{path:n}=t;n===undefined&&(n=t.target?function(e,t={}){if(!e)return[];const{includeSelf:n=!0,order:r="asc"}=t;let o=n?e:e.parentElement,i=[];for(;o;)i="asc"===r?i.concat(o):[o].concat(i),o=o.parentElement;return i}(t.target):[]);const o=n.find((e=>e.hasAttribute&&(e.hasAttribute("data-warden-container")||e.hasAttribute("data-warden-event-id")||e.hasAttribute("data-warden-title"))));if(!o)return;e.title=function(e={}){const t=l(e);if(t)return t;let n=e.parent;for(;n&&n!==document.body&&!n.hasAttribute("data-warden-container");)n=n.parent;const r=l(n);if(r)return r;const{tagName:o}=e;return e.hasChildNodes()&&"svg"!==o.toLowerCase()?function(e){const{tagName:t,textContent:n}=e;if("A"===t){return c([...e.children])?n:e.getAttribute("href")||null}if("BUTTON"===t){const t=e.getAttribute("name"),r=c([...e.children]);return t||r?n:e.getAttribute("href")||null}const{length:r}=[...e.children].filter((()=>e.hasChildNodes()));return r>0?null:n}(e):function(e){const{tagName:t,textContent:n}=e;if("IMG"===t)return e.getAttribute("alt")||null;if("svg"===t){const t=[...e.children].find((e=>"use"===e.tagName));if(t)return t.getAttribute("xlink:href")||null}return n}(e)}(o),e.eventId=function(e=[]){const t=u(e,"data-warden-event-id");if(t)return t.getAttribute("data-warden-event-id");const n=u(e,"title");if(n)return n.getAttribute("title");const r=u(e,"data-warden-container");if(r){if(r.getAttribute("data-warden-event-id")||r.getAttribute("title"))return r.getAttribute("data-warden-event-id")||r.getAttribute("title");const e=r.getAttribute("data-warden-container");if("string"==typeof e&&e)return e}return e[0].tagName.toLowerCase()}(n),e.params=function(e=[]){const t=/^data-warden-/;let n,r;try{e.forEach(((e,o)=>{const i=e&&e.attributes&&Array.from(e.attributes)||[];if(n=i.find((e=>e.nodeName.match(t)?e.nodeName.match(t):-1!==e.nodeName.indexOf("data-warden-container"))),n)throw r=o,Error()}))}catch(c){}if(r<0)return{};const o=e[r],i=Array.from(o.attributes)||[],a={};i.forEach((e=>{if(e.nodeName.indexOf("data-warden")<0)return;const n=e.nodeName.replace(t,"");a[n]=e.nodeValue}));return["container","title","event-id"].forEach((e=>{delete a[e]})),a}(n),e.elementPath=s(o).slice(-128);const{top:i,left:a}=t.target.getBoundingClientRect(),{scrollTop:d,scrollLeft:f}=document.documentElement,p=a+f,m=i+d;e.x=p,e.y=m,e.triggerTime=Date.now(),e.url=window.location.href,(0,r.j8)(e)}),!0)}function u(e,t){return e.find((e=>e.hasAttribute&&e.hasAttribute(t)))}function l(e){return e?e.hasAttribute("data-warden-title")?e.getAttribute("data-warden-title"):e.title:null}t.Z={init({eventCore:e,eventUnload:t}){(e||t)&&(e&&d(),function(e){const t=new i({eventType:"dwell"});window.addEventListener("load",(()=>{t.entryTime=Date.now()}),!0),e&&window.addEventListener("beforeunload",(()=>{t.eventId=(0,o.Vj)(),t.url=window.location.href,t.referer=document.referrer,t.triggerTime=Date.now(),t.millisecond=Date.now()-t.entryTime;const{type:e}=performance.navigation;t.operateAction={0:"navigate",1:"reload",2:"back_forward",255:"reserved"}[e]||null,(0,r.j8)(t,!0)}),!1)}(t))},traceCustomEvent(e,t,n={}){(0,r.j8)({eventId:e,title:t,params:n,eventType:"custom",triggerTime:Date.now()})}}},588:function(e,t,n){"use strict";var r=n(752),o=n(737);class i{constructor(e={}){["src","method","duration","responseStatus"].forEach((t=>{this[t]=e[t]||null}))}}t.Z={init({performanceServer:e,errorServer:t}){(e||t)&&(function(e,t){const{open:n,send:a}=XMLHttpRequest.prototype,c=new i;XMLHttpRequest.prototype.open=function(e,t,r){return c.requestMethod=e,c.src=t,n.call(this,e,t,r)},XMLHttpRequest.prototype.send=function(n){return this.addEventListener("readystatechange",(()=>{const{readyState:i,status:a,responseURL:s=c.src,responseText:d}=this;4===i&&(200===a||304===a?e&&o.Z.tracePerformance("server",{src:s,responseStatus:a,duration:Date.now()-c.triggerTime,params:n||undefined}):t&&r.Z.traceError("server",d,{src:s,responseStatus:a,params:n||undefined}))})),c.triggerTime=Date.now(),a.call(this,n)}}(e,t),function(e,t){const n=window.fetch;n&&(window.fetch=function(i,a={}){const c=Date.now(),{method:s="GET"}=a,d=n(i,a);return d.then((n=>{const{url:i,status:d,statusText:u}=n;200===d||304===d?e&&o.Z.tracePerformance("server",{src:i,duration:Date.now()-c,responseStatus:d,params:"POST"===s.toUpperCase()?a.body:undefined}):t&&r.Z.traceError("server",u,{src:i,responseStatus:d,params:"POST"===s.toUpperCase()?a.body:undefined})}),(e=>{r.Z.traceError("server",e.message,{src:i})})),d})}(e,t))}}},579:function(e,t,n){const r=n(328).ZP,o=n(923).Z,i=n(588).Z,a=n(752).Z,c=n(15).Z,s=n(737).Z,d=window._trace;if(d)e.exports=d;else{const t={setCustomerId:r.setCustomerId,setUserUuid:r.setUserUuid,traceError:a.traceError,tracePerformance:s.tracePerformance,traceCustomEvent:c.traceCustomEvent,tracePageView:o.tracePageView},n=(e={})=>{const t={requestUrl:"",appName:"",appCode:"",appVersion:"",ext:"",debug:!1,pvCore:!1,pvHashtag:!1,performanceCore:!1,performanceFirstResource:!1,performanceServer:!1,errorCore:!1,errorServer:!1,eventCore:!1,eventUnload:!1};!function(e,t){const{requestUrl:n,appName:r,appCode:o,appVersion:i,ext:a,debug:c,pv:s={},performance:d={},error:u={},event:l={}}=t;if(!n)throw Error("请传入requestUrl参数");if(!r)throw Error("请传入appName参数");e.requestUrl=n,e.appName=r,e.appCode=o,e.appVersion=i,e.ext=a,e.debug=c,"boolean"==typeof s?e.pvCore=e.pvHashtag=s:(e.pvCore=Boolean(s.core),e.pvHashtag=Boolean(s.server));"boolean"==typeof d?e.performanceCore=e.performanceFirstResource=e.performanceServer=d:(e.performanceCore=Boolean(d.core),e.performanceFirstResource=Boolean(d.firstResource),e.performanceServer=Boolean(d.server));"boolean"==typeof u?e.errorCore=e.errorServer=u:(e.errorCore=Boolean(u.core),e.errorServer=Boolean(u.server));"boolean"==typeof l?e.eventCore=e.eventUnload=l:(e.eventCore=Boolean(l.core),e.eventUnload=Boolean(l.unload))}(t,e),r.init(t),c.init(t),o.init(t),i.init(t),a.init(t),s.init(t)};e.exports={install:(e,r={})=>{n(r),e.prototype?e.prototype.$trace={...t}:e.config.globalProperties.$trace={...t}},init:n,...t}}},737:function(e,t,n){"use strict";var r=n(328);const o=!!window.performance,i=!(!window.performance||!performance.getEntriesByType),a="PerformanceObserver"in window,c="MutationObserver"in window,s="PerformanceNavigationTiming"in window,d={initiatorType:"",transferSize:0,encodedBodySize:0,decodedBodySize:0,duration:0,redirectStart:0,redirectEnd:0,startTime:0,fetchStart:0,domainLookupStart:0,domainLookupEnd:0,connectStart:0,connectEnd:0,requestStart:0,responseStart:0,responseEnd:0,workerStart:0};function u(e){return Object.keys(e).forEach((t=>{const n=e[t];"number"==typeof n&&(e[t]=0===n?undefined:parseFloat(n.toFixed(2)))})),e}function l(e){const t=["img","script","link","audio","video","css"],n=e.getEntriesByType("resource"),o=[];return n.forEach((e=>{const{initiatorType:n=""}=e;if(t.indexOf(n.toLowerCase())<0)return;const r={};Object.keys(d).forEach((t=>{r[t]=e[t]})),o.push(u({...r,eventType:"performance",eventId:"resource",src:e.name,triggerTime:Date.now(),url:window.location.href}))})),o.length&&(0,r.j8)(o),o}function f(){a?new PerformanceObserver(l).observe({entryTypes:["resource"]}):c&&function(){console.log("observeSourceInsert");const e=["img","script","link"];new MutationObserver((t=>{console.log("mutationsList",t);for(let n=0;n<t.length;n+=1){const o=Date.now(),{addedNodes:i=[]}=t[n],a=[];i.forEach((t=>{const{nodeName:n}=t;-1!==e.indexOf(n.toLowerCase())&&t.addEventListener("load",(()=>{const e=Date.now();a.push(u({eventType:"performance",eventId:"resource",src:t.src||t.href,duration:e-o,triggerTime:Date.now(),url:window.location.href}))}))})),(0,r.j8)(a)}})).observe(window.document,{subtree:!0,childList:!0})}()}function p(){l(window.performance),f()}function m(){const e={},{performance:t}=window;let n=t.timing;if(e.fmp=0,i){const r=t.getEntriesByType("paint");if(r.length&&(e.fmp=r[r.length-1].startTime),s){const e=t.getEntriesByType("navigation")[0];e&&(n=e)}}e.fmp&&s&&(e.fmp-=n.fetchStart),e.tti=n.domInteractive-n.fetchStart,e.ready=n.domContentLoadedEventEnd-n.fetchStart,e.loadon=n.loadEventStart-n.fetchStart,e.firstbyte=n.responseStart-n.domainLookupStart,e.dns=n.domainLookupEnd-n.domainLookupStart,e.appcache=n.domainLookupStart-n.fetchStart,e.tcp=n.connectEnd-n.connectStart,e.ttfb=n.responseStart-n.requestStart,e.trans=n.responseEnd-n.responseStart,e.dom=n.domInteractive-n.responseEnd,e.res=n.loadEventStart-n.domContentLoadedEventEnd,e.ssllink=n.connectEnd-n.secureConnectionStart,e.redirect=n.redirectEnd-n.redirectStart,e.unloadTime=n.unloadEventEnd-n.unloadEventStart,(0,r.j8)(u({...e,eventType:"performance",eventId:"page",url:window.location.href}))}t.Z={init({performanceFirstResource:e,performanceCore:t}){(e||t)&&("complete"===document.readyState?(o&&e&&m(),i&&t&&p()):window.addEventListener("load",(()=>{o&&e&&m(),i&&t&&p()})))},tracePerformance(e,t){console.log(123123);const n={triggerTime:Date.now(),url:window.location.href,...t,eventId:e,eventType:"performance"};(0,r.j8)(u(n))}}},923:function(e,t,n){"use strict";var r=n(328);let o=window.location.href,i=window.history.length;function a(e={}){const{url:t=window.location.href,referer:n=o,actions:a="",params:c}=e;let s=a;!s&&window.history.length<50&&(s=i===window.history.length?"back_forward":"navigation",i=window.history.length),setTimeout((()=>{(0,r.j8)({eventType:"pv",eventId:r.Hr,url:t,referer:n,params:c,title:e.title||document.title,action:s,triggerTime:Date.now()})}),e.title?0:17),o=t,i=window.history.length}t.Z={init:function(e={}){const{pvCore:t,pvHashtag:n}=e,r=document.referrer;if(!t)return;let i=!1;if(a({url:o,referer:r}),window.history.pushState){const e=window.history.pushState.bind(window.history);window.history.pushState=(t,n,r)=>{i=!1;const o=e(t,n,r);return a({actions:"navigation"}),o};const t=window.history.replaceState.bind(window.history);window.history.replaceState=(e,n,r)=>{i=!1;const o=t(e,n,r);return a({actions:"navigation"}),o},window.addEventListener("popstate",(()=>{if(""!==window.location.hash){const e=o.indexOf("#")>0?o.slice(0,o.indexOf("#")):o;if(window.location.href.slice(0,window.location.href.indexOf("#"))===e&&!n)return}i=!0,a()}))}window.addEventListener("hashchange",(()=>{n&&!i&&a(),i=!1}))},tracePageView:a}},839:function(e,t,n){"use strict";function r(e,t,n="0"){const r=String(e);if(r.length<t){let e=r;for(let o=0;o<t-r.length;o+=1)e=n+e;return e}return r}function o(){const e=new Date,t=parseInt(`${e.getFullYear()}${r(e.getMonth()+1,2)}${r(e.getDate(),2)}`,10).toString(16),n=parseInt(`${r(e.getHours(),2)}${r(e.getMinutes(),2)}${r(e.getSeconds(),2)}${r(e.getMilliseconds(),3)}`,10).toString(16);let o=t+n.length+n;for(;o.length<32;)o+=Math.floor(16*Math.random()).toString(16);return`${o.slice(0,8)}-${o.slice(8,16)}-${o.slice(16)}`}function i(e){const t=document.cookie.match(new RegExp(`${e}=([^;]+)(;|$)`));return t?t[1]:undefined}n.d(t,{Vj:function(){return o},A7:function(){return i},Zv:function(){return a},UI:function(){return s},hX:function(){return u},Rq:function(){return l}});const a=navigator.sendBeacon?(e,t)=>{t&&navigator.sendBeacon(e,JSON.stringify(t))}:(e,t)=>{(new Image).src=`${e}?v=${encodeURIComponent(JSON.stringify(t))}`},c=Array.prototype.map||function(e){const t=[];for(let n=0;n<this.length;n+=1)t.push(e(this[n],n,this));return t};function s(e,t){return c.call(e,t)}const d=Array.prototype.filter||function(e){const t=[];for(let n=0;n<this.length;n+=1)e(this[n],n,this)&&t.push(this[n]);return t};function u(e,t){return d.call(e,t)}Array.prototype.find;const l=window.requestIdleCallback||window.requestAnimationFrame||(e=>setTimeout(e,17));window.cancelIdleCallback||window.cancelAnimationFrame||clearTimeout}},t={};function n(r){var o=t[r];if(o!==undefined)return o.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}return n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n(579)}()}));